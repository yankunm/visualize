<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HTML File Selector</title>
</head>
<body>

  <h1>Graphically Modeling ASAP Essay Dataset</h1>

  <!-- Dropdown menu for selecting HTML files -->
  <label for="fileSelector">Select an Essay:</label>
  <select id="fileSelector" onchange="loadFile()">
    <option value="">None</option>
  </select>

  <!-- iframe to display the selected HTML file -->
  <div>
    <iframe id="fileContent" width="600" height="800" frameborder="0"></iframe>
  </div>
  

  <script>
    async function populateDropdown() {
        var select = document.getElementById("fileSelector");

        try {
            // Fetch a list of HTML files from the server
            const response = await fetch('http://127.0.0.1:5000/file-list', {
                method: 'GET',
                headers: {
                    'Access-Control-Allow-Origin': '*',
                }
            });
            const files = await response.json();
            console.log(files);
            
            // Populate dropdown with options
            files.forEach(function (file) {
            var option = document.createElement("option");
            option.value = "./visualizations/" + file;
            option.text = "Essay " + file.match(/\d+/)[0];
            console.log(option.value);
            select.add(option);
            });
        } catch (error) {
            console.error('Error fetching file list:', error);
        }
    }

    // Function to load the selected HTML file into the iframe
    function loadFile() {
      var select = document.getElementById("fileSelector");
      var file = select.options[select.selectedIndex].value;

      // Set the iframe source to the selected HTML file
      document.getElementById("fileContent").src = file;
    }

    // Initial population of the dropdown
    populateDropdown().then(loadFile());
  </script>

</body>
</html>
